<project name="demo">

    <property name="src.dir" location="src"/>
    <property name="build.dir" location="bin"/>
    <property name="vendor.dir" location="vendor"/>


    <target name="clean">
        <delete dir="${build.dir}"/>
        <delete dir="${vendor.dir}"/>
    </target>

    <target name="makedir">
        <mkdir dir="${build.dir}"/>
    </target>

    <target name="dep">
        <exec executable="go">
            <arg value="mod"/>
            <arg value="tidy"/>
        </exec>
        <exec executable="go">
            <arg value="mod"/>
            <arg value="vendor"/>
        </exec>
    </target>

    <target name="compile" depends="clean, makedir, dep">
        <exec executable="go">
            <arg value="build"/>
            <arg value="-o"/>
            <arg value="/${build.dir}/main"/>
        </exec>
    </target>

    <target name="test">
        <exec executable="go">
            <arg value="test"/>
            <arg value="-coverprofile=coverage.out"/>
        </exec>
    </target>

</project>
